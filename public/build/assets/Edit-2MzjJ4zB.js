import{x,j as e,Q as h,V as l}from"./app-DV11kIX4.js";import{A as v}from"./AuthenticatedLayout-DpWHPObg.js";import{I as s}from"./InputLabel-CTZ616YD.js";import{T as r}from"./TextInput-B9zfG8uM.js";import{P as g}from"./PrimaryButton-0t_KFMRk.js";import"./transition-DDvhwGQf.js";function w({sale:t}){const m=a=>a?new Date(a).toISOString().split("T")[0]:"",{data:o,setData:n,put:u,processing:d}=x({client_name:t.client_name||"",total_amount:t.total_amount?parseFloat(t.total_amount).toString():"",shipping_amount:t.shipping_amount?parseFloat(t.shipping_amount).toString():"",payment_method:t.payment_method||"pix",received_amount:t.received_amount?parseFloat(t.received_amount).toString():"",payment_date:m(t.payment_date),payment_receipt:null,notes:t.notes||""}),c=a=>{a.preventDefault(),u(route("sales.update",t.id),{onSuccess:()=>{l.success("Venda atualizada com sucesso!")},onError:i=>{Object.keys(i).forEach(p=>{l.error(i[p])})}})};return e.jsxs(v,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:["Editar Venda #",t.id]}),children:[e.jsx(h,{title:`Editar Venda #${t.id} - BBKits`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[t.status!=="pendente"&&e.jsx("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["⚠️ ",e.jsx("strong",{children:"Atenção:"})," Esta venda já foi processada e não pode ser editada."]})}),e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"client_name",value:"Nome da Cliente"}),e.jsx(r,{id:"client_name",type:"text",className:"mt-1 block w-full",value:o.client_name,onChange:a=>n("client_name",a.target.value),required:!0,disabled:t.status!=="pendente"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"payment_method",value:"Forma de Pagamento"}),e.jsxs("select",{id:"payment_method",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 disabled:bg-gray-100",value:o.payment_method,onChange:a=>n("payment_method",a.target.value),required:!0,disabled:t.status!=="pendente",children:[e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"boleto",children:"Boleto"}),e.jsx("option",{value:"cartao",children:"Cartão"}),e.jsx("option",{value:"dinheiro",children:"Dinheiro"})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"total_amount",value:"Valor Total do Pedido (R$)"}),e.jsx(r,{id:"total_amount",type:"number",step:"0.01",min:"0",className:"mt-1 block w-full",value:o.total_amount,onChange:a=>n("total_amount",a.target.value),required:!0,disabled:t.status!=="pendente"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"shipping_amount",value:"Valor do Frete (R$)"}),e.jsx(r,{id:"shipping_amount",type:"number",step:"0.01",min:"0",className:"mt-1 block w-full",value:o.shipping_amount,onChange:a=>n("shipping_amount",a.target.value),required:!0,disabled:t.status!=="pendente"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"received_amount",value:"Valor Recebido (R$)"}),e.jsx(r,{id:"received_amount",type:"number",step:"0.01",min:"0",className:"mt-1 block w-full",value:o.received_amount,onChange:a=>n("received_amount",a.target.value),required:!0,disabled:t.status!=="pendente"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"payment_date",value:"Data do Pagamento"}),e.jsx(r,{id:"payment_date",type:"date",className:"mt-1 block w-full",value:o.payment_date,onChange:a=>n("payment_date",a.target.value),required:!0,disabled:t.status!=="pendente"})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"payment_receipt",value:"Comprovante de Pagamento"}),t.payment_receipt&&e.jsx("div",{className:"mb-2",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Comprovante atual:",e.jsx("a",{href:`/storage/${t.payment_receipt}`,target:"_blank",rel:"noopener noreferrer",className:"ml-1 text-blue-600 hover:text-blue-800 underline",children:"Ver arquivo"})]})}),e.jsx("input",{id:"payment_receipt",type:"file",accept:"image/*,application/pdf",className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100 disabled:opacity-50",onChange:a=>n("payment_receipt",a.target.files[0]),disabled:t.status!=="pendente"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t.status==="pendente"?"Deixe em branco para manter o comprovante atual. Formatos aceitos: JPG, PNG, PDF (máx. 2MB)":"Não é possível alterar o comprovante de uma venda já processada."})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"notes",value:"Observações (opcional)"}),e.jsx("textarea",{id:"notes",rows:"3",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 disabled:bg-gray-100",value:o.notes,onChange:a=>n("notes",a.target.value),placeholder:"Informações adicionais sobre a venda...",disabled:t.status!=="pendente"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx("a",{href:route("sales.index"),className:"text-gray-600 hover:text-gray-900",children:"Cancelar"}),t.status==="pendente"&&e.jsx(g,{disabled:d,children:d?"Salvando...":"Atualizar Venda"})]})]})]})})})})]})}export{w as default};
