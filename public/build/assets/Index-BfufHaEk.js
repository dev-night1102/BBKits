import{r as m,x as w,j as e,Q as _,t as p,V as d}from"./app-D56oPoK1.js";import{A as k}from"./AuthenticatedLayout-C_3_mSLc.js";import"./transition-BL1db5zo.js";function C({sales:a}){const[u,o]=m.useState(!1),[s,c]=m.useState(null),{data:h,setData:g,post:i,processing:r,reset:x}=w({rejection_reason:""}),y=t=>{const n={pendente:"bg-yellow-100 text-yellow-800",aprovado:"bg-green-100 text-green-800",recusado:"bg-red-100 text-red-800",cancelado:"bg-gray-100 text-gray-800",estornado:"bg-purple-100 text-purple-800"},N={pendente:"Pendente",aprovado:"Aprovado",recusado:"Recusado",cancelado:"Cancelado",estornado:"Estornado"};return e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${n[t]}`,children:N[t]})},l=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),j=t=>new Date(t).toLocaleDateString("pt-BR"),f=t=>{i(route("admin.sales.approve",t.id),{onSuccess:()=>{d.success("Venda aprovada com sucesso!")},onError:()=>{d.error("Erro ao aprovar venda.")}})},v=t=>{c(t),o(!0)},b=t=>{t.preventDefault(),i(route("admin.sales.reject",s.id),{onSuccess:()=>{d.success("Venda recusada."),o(!1),c(null),x()},onError:()=>{d.error("Erro ao recusar venda.")}})};return e.jsxs(k,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Painel Financeiro - Aprovação de Vendas"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.data.filter(t=>t.status==="pendente").length," vendas pendentes"]})]}),children:[e.jsx(_,{title:"Painel Financeiro - BBKits"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 text-gray-900",children:a.data.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Nenhuma venda registrada"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"As vendas aparecerão aqui quando as vendedoras registrarem."})]}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Vendedora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Valor Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Valor Recebido"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Data Pagamento"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:a.data.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900",children:t.user.name}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:t.client_name}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:l(t.total_amount)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:l(t.received_amount)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:j(t.payment_date)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:y(t.status)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{href:route("sales.show",t.id),className:"text-indigo-600 hover:text-indigo-900",children:"Ver"}),t.status==="pendente"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(t),className:"text-green-600 hover:text-green-900",disabled:r,children:"Aprovar"}),e.jsx("button",{onClick:()=>v(t),className:"text-red-600 hover:text-red-900",disabled:r,children:"Recusar"})]}),t.payment_receipt&&e.jsx("a",{href:`/storage/${t.payment_receipt}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-900",children:"Comprovante"})]})})]},t.id))})]}),a.links&&a.links.length>0&&e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando ",a.from," a ",a.to," de ",a.total," resultados"]}),e.jsx("div",{className:"flex space-x-2",children:a.links.filter(t=>t&&t.url!==null).map((t,n)=>t.url?e.jsx(p,{href:t.url,className:`px-3 py-2 text-sm rounded-md ${t.active?"bg-pink-600 text-white":"bg-white text-gray-500 hover:text-gray-700"}`,dangerouslySetInnerHTML:{__html:t.label}},n):e.jsx("span",{className:"px-3 py-2 text-sm rounded-md bg-gray-100 text-gray-400 cursor-not-allowed",dangerouslySetInnerHTML:{__html:t.label}},n))})]})]})})})})}),u&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recusar Venda"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Cliente: ",e.jsx("strong",{children:s==null?void 0:s.client_name}),e.jsx("br",{}),"Valor: ",e.jsx("strong",{children:s&&l(s.received_amount)})]}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"rejection_reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo da recusa"}),e.jsx("textarea",{id:"rejection_reason",value:h.rejection_reason,onChange:t=>g("rejection_reason",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500",rows:"3",required:!0,placeholder:"Descreva o motivo da recusa..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{o(!1),c(null),x()},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:r,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md disabled:opacity-50",children:r?"Recusando...":"Recusar Venda"})]})]})]})})})]})}export{C as default};
